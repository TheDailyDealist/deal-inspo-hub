<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Connecting to Pinterest...</title>
    <style>
        body { 
            font-family: Arial; 
            max-width: 600px; 
            margin: 50px auto; 
            text-align: center; 
            padding: 20px;
        }
        .loading { color: #666; margin: 20px 0; }
        .error { color: #e60023; margin: 20px 0; }
        .success { color: #28a745; margin: 20px 0; }
        pre { 
            background: #f5f5f5; 
            padding: 15px; 
            border-radius: 5px; 
            text-align: left;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>üîó Connecting to Pinterest</h1>
    <div id="status" class="loading">Processing authorization...</div>
    <div id="result"></div>
    <div id="next-steps"></div>

    <script>
        // –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL
        const urlParams = new URLSearchParams(window.location.search);
        const code = urlParams.get('code');
        const state = urlParams.get('state');
        const error = urlParams.get('error');

        const statusDiv = document.getElementById('status');
        const resultDiv = document.getElementById('result');
        const nextStepsDiv = document.getElementById('next-steps');

        if (error) {
            statusDiv.className = 'error';
            statusDiv.textContent = '‚ùå Authorization failed';
            resultDiv.innerHTML = `<p>Error: ${error}</p>`;
        } else if (code) {
            statusDiv.className = 'success';
            statusDiv.textContent = '‚úÖ Authorization successful!';
            
            resultDiv.innerHTML = `
                <p>Authorization code received:</p>
                <pre>${code}</pre>
                <p><strong>State:</strong> ${state}</p>
            `;

            nextStepsDiv.innerHTML = `
                <h3>Next Steps:</h3>
                <p>Now you need to exchange this code for an access token.</p>
                <p>Use this code in your backend to make a POST request to:</p>
                <pre>https://api.pinterest.com/v5/oauth/token</pre>
                <p><small>Note: The code expires in 10 minutes</small></p>
                <p><a href="index.html">‚Üê Back to home</a></p>
            `;

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–æ–¥ –≤ localStorage –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
            localStorage.setItem('pinterest_auth_code', code);
            localStorage.setItem('pinterest_auth_state', state);
        } else {
            statusDiv.className = 'error';
            statusDiv.textContent = '‚ùå No authorization code received';
            resultDiv.innerHTML = '<p>Something went wrong. Please try again.</p>';
            nextStepsDiv.innerHTML = '<p><a href="index.html">‚Üê Back to home</a></p>';
        }
    </script>
</body>
</html>
